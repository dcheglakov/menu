"use strict";angular.module("OldCityMenu",["ui.bootstrap"]).directive("itemsNumberPicker",function(){return{templateUrl:"assets/templates/itemsNumberPicker.html",restrict:"EA",require:"?ngModel",scope:{},link:function e(n,t){n.model=n.$eval(t.$modelValue)}}}).service("gapiApps",function(){return{localhost:"745107026144-m21vqtv13v70eabpto9mc8ajqh8p9tec.apps.googleusercontent.com","dcheglakov.com":"745107026144-mg8hd3coa8gckgh1keoclklqsj77jhou.apps.googleusercontent.com","192.168.1.156":"745107026144-8bqqkqm4l578fbpbukjp7du6s4mbhg1k.apps.googleusercontent.com"}}).controller("WeekMenuCtrl",function(e,n,t,o){e.weekItems=[],e.menuItems=[],e.menuPrices=[],e.getDayOrderString=function(n){var t=[];return angular.forEach(e.menuPrices,function(e,o){n.menu[o].ordered>0&&t.push([n.menu[o].ordered," * ",e].join(""))}),t.join(" + ")},e.getDayOrderCost=function(n){var t=0;return angular.forEach(e.menuPrices,function(e,o){n.menu[o].ordered>0&&(t+=n.menu[o].ordered*e)}),t},e.getWeekMenuItems=function(){n.get("menu_items.json").then(function(t){e.menuItems=t.data.menu,e.menuPrices=t.data.prices,n.get("sample_menu.json").then(function(n){var t=(new Date).getDay();e.weekItems.length=0,angular.extend(e.weekItems,n.data),e.weekItems[t-1].isOpen=!0;var o=new Date,r=new Date(o.getFullYear(),o.getMonth(),o.getDay());angular.forEach(e.weekItems,function(e,n){var t=new Date(r);t.setDate(r.getDate()-r.getDay()+1+n),e.date=[t.getDate(),t.getMonth()+1,t.getFullYear()].join(".")})})})},e.auth={signedIn:!1},e.processAuth=function(n){n.status.signed_in?e.getMe():n.error&&console.log("Sign-in state: "+n.error)},e.signInCallback=function(n){e.$apply(function(){e.processAuth(n)})},e.renderSignInButton=function(){gapi.signin.render("signInButton",{callback:e.signInCallback,clientid:o[t.host()],scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email",cookiepolicy:"single_host_origin"})},e.getMe=function(){gapi.client.load("plus","v1",function(){var n=gapi.client.plus.people.get({userId:"me"});n.execute(function(n){e.$apply(function(){void 0==n.error&&(e.auth.signedIn=!0,e.auth.profile=n)})})})},e.renderSignInButton(),e.$watch("auth.signedIn",function(n){n&&e.getWeekMenuItems()})});